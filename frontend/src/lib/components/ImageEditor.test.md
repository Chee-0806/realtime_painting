# ImageEditor 组件测试指南

## 测试任务 8.2: 裁剪/旋转/缩放功能

### 功能概述

ImageEditor组件现在支持以下编辑工具：

1. **裁剪工具** - 选择并裁剪图像的特定区域
2. **旋转工具** - 90度增量旋转和自定义角度旋转
3. **缩放工具** - 调整图像尺寸，支持保持宽高比

### 测试步骤

#### 1. 裁剪工具测试

**步骤：**
1. 上传一张测试图像
2. 点击"开始裁剪"按钮
3. 在画布上拖动鼠标选择裁剪区域
   - 鼠标光标应变为十字准星
   - 拖动时应显示绿色边框和半透明遮罩
4. 释放鼠标后，点击"✓ 应用裁剪"
5. 验证图像被正确裁剪到选定区域

**预期结果：**
- ✅ 裁剪框实时显示
- ✅ 裁剪区域外有半透明遮罩
- ✅ 应用后图像尺寸改变
- ✅ 可以撤销裁剪操作
- ✅ 可以取消裁剪操作

**边界情况：**
- 裁剪区域太小（<10px）应被忽略
- 裁剪后canvas尺寸应更新

#### 2. 旋转工具测试

**2.1 90度增量旋转**

**步骤：**
1. 上传一张测试图像
2. 点击"↻ 90°"按钮
3. 验证图像顺时针旋转90度
4. 点击"↻ 180°"按钮
5. 验证图像旋转180度
6. 点击"↻ 270°"按钮
7. 验证图像顺时针旋转270度（逆时针90度）

**预期结果：**
- ✅ 90度和270度旋转时宽高互换
- ✅ 180度旋转时宽高不变
- ✅ 旋转后图像不失真
- ✅ 当前旋转角度正确显示
- ✅ 可以撤销旋转操作

**2.2 自定义角度旋转**

**步骤：**
1. 在"自定义角度"输入框输入45
2. 点击"应用"按钮
3. 验证图像旋转45度
4. 输入-30并应用
5. 验证图像逆时针旋转30度

**预期结果：**
- ✅ 支持-360到360度的角度
- ✅ 旋转角度累加显示
- ✅ 角度为0时"应用"按钮禁用
- ✅ 可以撤销旋转操作

#### 3. 缩放工具测试

**3.1 保持宽高比缩放**

**步骤：**
1. 上传一张测试图像
2. 确保"保持宽高比"复选框已选中
3. 拖动"宽度缩放"滑块到2.0x
4. 验证"高度缩放"自动同步到2.0x
5. 点击"应用缩放"按钮
6. 验证图像放大2倍

**预期结果：**
- ✅ 宽度和高度同步变化
- ✅ 高度滑块被禁用
- ✅ 缩放比例实时显示
- ✅ 图像尺寸正确改变
- ✅ 可以撤销缩放操作

**3.2 独立宽高缩放**

**步骤：**
1. 取消"保持宽高比"复选框
2. 设置宽度缩放为1.5x
3. 设置高度缩放为0.5x
4. 点击"应用缩放"按钮
5. 验证图像宽度增加50%，高度减少50%

**预期结果：**
- ✅ 宽度和高度独立调整
- ✅ 高度滑块可用
- ✅ 图像可以被拉伸或压缩
- ✅ 可以撤销缩放操作

**边界情况：**
- 缩放比例为1.0时"应用缩放"按钮禁用
- 缩放范围限制在0.1x到3.0x

#### 4. 组合操作测试

**步骤：**
1. 上传图像
2. 先旋转90度
3. 然后缩放2倍
4. 最后裁剪一部分
5. 使用撤销功能逐步回退
6. 使用重做功能恢复操作

**预期结果：**
- ✅ 多个操作可以连续执行
- ✅ 每个操作都保存到历史记录
- ✅ 撤销/重做功能正常
- ✅ 历史记录计数正确

#### 5. 重置功能测试

**步骤：**
1. 执行多个编辑操作（旋转、缩放、裁剪）
2. 点击"🔄 重置"按钮
3. 验证图像恢复到原始状态

**预期结果：**
- ✅ 图像恢复到上传时的状态
- ✅ 所有编辑参数重置
- ✅ 历史记录清空
- ✅ 工具状态重置

### 性能测试

**大图像测试：**
- 上传2000x2000像素的图像
- 执行旋转、缩放、裁剪操作
- 验证操作流畅，无明显卡顿

**历史记录测试：**
- 连续执行20+次操作
- 验证历史记录限制在20条
- 验证撤销/重做功能正常

### 错误处理测试

**无效输入：**
- 尝试在未加载图像时使用工具
- 输入无效的旋转角度
- 验证错误提示正确显示

### UI/UX测试

**视觉反馈：**
- ✅ 裁剪时光标变为十字准星
- ✅ 裁剪框有明显的视觉提示
- ✅ 按钮状态正确（启用/禁用）
- ✅ 滑块值实时显示

**响应式：**
- 在不同屏幕尺寸下测试
- 验证布局正常

### 已知限制

1. 自定义角度旋转可能导致图像边缘被裁剪（非正交旋转）
2. 大角度旋转后canvas尺寸不会自动调整以适应旋转后的图像
3. 裁剪工具不支持精确数值输入

### 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 裁剪工具 | ⏳ 待测试 | |
| 90度旋转 | ⏳ 待测试 | |
| 180度旋转 | ⏳ 待测试 | |
| 270度旋转 | ⏳ 待测试 | |
| 自定义角度旋转 | ⏳ 待测试 | |
| 保持宽高比缩放 | ⏳ 待测试 | |
| 独立宽高缩放 | ⏳ 待测试 | |
| 组合操作 | ⏳ 待测试 | |
| 撤销/重做 | ⏳ 待测试 | |
| 重置功能 | ⏳ 待测试 | |

### 测试完成标准

- [ ] 所有基础功能测试通过
- [ ] 边界情况处理正确
- [ ] 错误提示清晰
- [ ] 性能满足要求
- [ ] UI/UX符合预期

---

**测试人员：** _待填写_  
**测试日期：** _待填写_  
**测试版本：** v1.0
