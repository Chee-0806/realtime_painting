import{s as pe,f as w,a as B,l as M,g as D,h as A,u as X,c as I,m as U,d as k,j as h,i as S,v as m,w as R,n as G,C as Z,E as Ze,B as xe,A as se,p as tt,K as te,e as ue,H as ne,J as fe,o as lt,L as de}from"./scheduler.ae4f2bff.js";import{S as me,i as ve,a as ee,g as be,c as ge,t as oe,b as st,d as nt,m as ot,e as rt}from"./index.92b2b836.js";import{e as K}from"./each.fa7c727b.js";import{d as at,w as $e}from"./index.fa5aef85.js";var it=(l=>(l.NETWORK="network",l.API="api",l.VALIDATION="validation",l.MODEL="model",l.GENERATION="generation",l.WEBSOCKET="websocket",l))(it||{});const et=$e({hasError:!1,error:null});function Vt(l){et.set({hasError:!0,error:l})}function At(){et.set({hasError:!1,error:null})}const le=$e({});function Bt(){let l={};return le.subscribe(e=>{l=e})(),l}function It(){let l={};return ut.subscribe(e=>{l=e})(),l}let he=null,Ee={};const ut=at(le,(l,e)=>{Ee=l,he&&clearTimeout(he),he=setTimeout(()=>{e(Ee)},300)},{});function Ce(l,e,t){const s=l.slice();return s[22]=e[t],s[24]=t,s}function Te(l,e,t){const s=l.slice();return s[25]=e[t],s}function we(l,e,t){const s=l.slice();return s[28]=e[t],s}function De(l){let e,t,s,o="Promptæ¨¡æ¿",a,n,u="âœ•",r,i,c,p,v=K(l[4]),f=[];for(let _=0;_<v.length;_+=1)f[_]=Ve(we(l,v,_));return{c(){e=w("div"),t=w("div"),s=w("h4"),s.textContent=o,a=B(),n=w("button"),n.textContent=u,r=B(),i=w("div");for(let _=0;_<f.length;_+=1)f[_].c();this.h()},l(_){e=D(_,"DIV",{class:!0});var b=A(e);t=D(b,"DIV",{class:!0});var d=A(t);s=D(d,"H4",{class:!0,"data-svelte-h":!0}),X(s)!=="svelte-10uqqgk"&&(s.textContent=o),a=I(d),n=D(d,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(n)!=="svelte-1nr5er5"&&(n.textContent=u),d.forEach(k),r=I(b),i=D(b,"DIV",{class:!0});var y=A(i);for(let O=0;O<f.length;O+=1)f[O].l(y);y.forEach(k),b.forEach(k),this.h()},h(){h(s,"class","text-sm font-semibold"),h(n,"type","button"),h(n,"class","text-text-secondary hover:text-text-primary"),h(t,"class","flex justify-between items-center mb-2"),h(i,"class","grid grid-cols-2 gap-2"),h(e,"class","tool-panel svelte-flvc7i")},m(_,b){S(_,e,b),m(e,t),m(t,s),m(t,a),m(t,n),m(e,r),m(e,i);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(i,null);c||(p=R(n,"click",l[14]),c=!0)},p(_,b){if(b&80){v=K(_[4]);let d;for(d=0;d<v.length;d+=1){const y=we(_,v,d);f[d]?f[d].p(y,b):(f[d]=Ve(y),f[d].c(),f[d].m(i,null))}for(;d<f.length;d+=1)f[d].d(1);f.length=v.length}},d(_){_&&k(e),se(f,_),c=!1,p()}}}function Ve(l){let e,t=l[28].name+"",s,o,a,n;function u(){return l[15](l[28])}return{c(){e=w("button"),s=M(t),o=B(),this.h()},l(r){e=D(r,"BUTTON",{type:!0,class:!0});var i=A(e);s=U(i,t),o=I(i),i.forEach(k),this.h()},h(){h(e,"type","button"),h(e,"class","btn-ghost text-sm text-left svelte-flvc7i"),e.disabled=!l[28].value},m(r,i){S(r,e,i),m(e,s),m(e,o),a||(n=R(e,"click",u),a=!0)},p(r,i){l=r},d(r){r&&k(e),a=!1,n()}}}function Ae(l){let e,t,s,o="é€šé…ç¬¦",a,n,u="âœ•",r,i,c,p,v="ğŸ’¡ é€šé…ç¬¦ä¼šåœ¨ç”Ÿæˆæ—¶éšæœºé€‰æ‹©ä¸€ä¸ªé€‰é¡¹",f,_,b=K(l[5]),d=[];for(let y=0;y<b.length;y+=1)d[y]=Be(Te(l,b,y));return{c(){e=w("div"),t=w("div"),s=w("h4"),s.textContent=o,a=B(),n=w("button"),n.textContent=u,r=B(),i=w("div");for(let y=0;y<d.length;y+=1)d[y].c();c=B(),p=w("div"),p.textContent=v,this.h()},l(y){e=D(y,"DIV",{class:!0});var O=A(e);t=D(O,"DIV",{class:!0});var g=A(t);s=D(g,"H4",{class:!0,"data-svelte-h":!0}),X(s)!=="svelte-1qs26hx"&&(s.textContent=o),a=I(g),n=D(g,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(n)!=="svelte-s58fe1"&&(n.textContent=u),g.forEach(k),r=I(O),i=D(O,"DIV",{class:!0});var E=A(i);for(let F=0;F<d.length;F+=1)d[F].l(E);E.forEach(k),c=I(O),p=D(O,"DIV",{class:!0,"data-svelte-h":!0}),X(p)!=="svelte-11kx15x"&&(p.textContent=v),O.forEach(k),this.h()},h(){h(s,"class","text-sm font-semibold"),h(n,"type","button"),h(n,"class","text-text-secondary hover:text-text-primary"),h(t,"class","flex justify-between items-center mb-2"),h(i,"class","space-y-1"),h(p,"class","mt-2 text-xs text-text-secondary"),h(e,"class","tool-panel svelte-flvc7i")},m(y,O){S(y,e,O),m(e,t),m(t,s),m(t,a),m(t,n),m(e,r),m(e,i);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(i,null);m(e,c),m(e,p),f||(_=R(n,"click",l[16]),f=!0)},p(y,O){if(O&160){b=K(y[5]);let g;for(g=0;g<b.length;g+=1){const E=Te(y,b,g);d[g]?d[g].p(E,O):(d[g]=Be(E),d[g].c(),d[g].m(i,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=b.length}},d(y){y&&k(e),se(d,y),f=!1,_()}}}function Be(l){let e,t,s=l[25].name+"",o,a,n,u,r=l[25].value+"",i,c,p,v;function f(){return l[17](l[25])}return{c(){e=w("button"),t=w("span"),o=M(s),a=M(":"),n=B(),u=w("span"),i=M(r),c=B(),this.h()},l(_){e=D(_,"BUTTON",{type:!0,class:!0});var b=A(e);t=D(b,"SPAN",{class:!0});var d=A(t);o=U(d,s),a=U(d,":"),d.forEach(k),n=I(b),u=D(b,"SPAN",{class:!0});var y=A(u);i=U(y,r),y.forEach(k),c=I(b),b.forEach(k),this.h()},h(){h(t,"class","font-medium"),h(u,"class","text-text-secondary ml-2"),h(e,"type","button"),h(e,"class","btn-ghost text-sm text-left w-full svelte-flvc7i")},m(_,b){S(_,e,b),m(e,t),m(t,o),m(t,a),m(e,n),m(e,u),m(u,i),m(e,c),p||(v=R(e,"click",f),p=!0)},p(_,b){l=_},d(_){_&&k(e),p=!1,v()}}}function Ie(l){let e,t,s,o="å†å²è®°å½•",a,n,u,r,i="âœ•",c,p,v,f=l[0].length>0&&Oe(l);function _(y,O){return y[0].length>0?ft:ct}let b=_(l),d=b(l);return{c(){e=w("div"),t=w("div"),s=w("h4"),s.textContent=o,a=B(),n=w("div"),f&&f.c(),u=B(),r=w("button"),r.textContent=i,c=B(),d.c(),this.h()},l(y){e=D(y,"DIV",{class:!0});var O=A(e);t=D(O,"DIV",{class:!0});var g=A(t);s=D(g,"H4",{class:!0,"data-svelte-h":!0}),X(s)!=="svelte-bc44s9"&&(s.textContent=o),a=I(g),n=D(g,"DIV",{class:!0});var E=A(n);f&&f.l(E),u=I(E),r=D(E,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(r)!=="svelte-16xurtw"&&(r.textContent=i),E.forEach(k),g.forEach(k),c=I(O),d.l(O),O.forEach(k),this.h()},h(){h(s,"class","text-sm font-semibold"),h(r,"type","button"),h(r,"class","text-text-secondary hover:text-text-primary"),h(n,"class","flex gap-2"),h(t,"class","flex justify-between items-center mb-2"),h(e,"class","tool-panel svelte-flvc7i")},m(y,O){S(y,e,O),m(e,t),m(t,s),m(t,a),m(t,n),f&&f.m(n,null),m(n,u),m(n,r),m(e,c),d.m(e,null),p||(v=R(r,"click",l[18]),p=!0)},p(y,O){y[0].length>0?f?f.p(y,O):(f=Oe(y),f.c(),f.m(n,u)):f&&(f.d(1),f=null),b===(b=_(y))&&d?d.p(y,O):(d.d(1),d=b(y),d&&(d.c(),d.m(e,null)))},d(y){y&&k(e),f&&f.d(),d.d(),p=!1,v()}}}function Oe(l){let e,t="æ¸…é™¤",s,o;return{c(){e=w("button"),e.textContent=t,this.h()},l(a){e=D(a,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1bkzk03"&&(e.textContent=t),this.h()},h(){h(e,"type","button"),h(e,"class","text-xs text-text-secondary hover:text-text-primary")},m(a,n){S(a,e,n),s||(o=R(e,"click",l[9]),s=!0)},p:Z,d(a){a&&k(e),s=!1,o()}}}function ct(l){let e,t="æš‚æ— å†å²è®°å½•";return{c(){e=w("div"),e.textContent=t,this.h()},l(s){e=D(s,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1194m5b"&&(e.textContent=t),this.h()},h(){h(e,"class","text-sm text-text-secondary text-center py-4")},m(s,o){S(s,e,o)},p:Z,d(s){s&&k(e)}}}function ft(l){let e,t=K(l[0]),s=[];for(let o=0;o<t.length;o+=1)s[o]=Ne(Ce(l,t,o));return{c(){e=w("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=D(o,"DIV",{class:!0});var a=A(e);for(let n=0;n<s.length;n+=1)s[n].l(a);a.forEach(k),this.h()},h(){h(e,"class","space-y-1 max-h-60 overflow-y-auto")},m(o,a){S(o,e,a);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null)},p(o,a){if(a&257){t=K(o[0]);let n;for(n=0;n<t.length;n+=1){const u=Ce(o,t,n);s[n]?s[n].p(u,a):(s[n]=Ne(u),s[n].c(),s[n].m(e,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=t.length}},d(o){o&&k(e),se(s,o)}}}function Ne(l){let e,t=l[24]+1+"",s,o,a=l[22]+"",n,u,r,i,c;function p(){return l[19](l[22])}return{c(){e=w("button"),s=M(t),o=M(". "),n=M(a),u=B(),this.h()},l(v){e=D(v,"BUTTON",{type:!0,class:!0,title:!0});var f=A(e);s=U(f,t),o=U(f,". "),n=U(f,a),u=I(f),f.forEach(k),this.h()},h(){h(e,"type","button"),h(e,"class","btn-ghost text-sm text-left w-full truncate svelte-flvc7i"),h(e,"title",r=l[22])},m(v,f){S(v,e,f),m(e,s),m(e,o),m(e,n),m(e,u),i||(c=R(e,"click",p),i=!0)},p(v,f){l=v,f&1&&a!==(a=l[22]+"")&&G(n,a),f&1&&r!==(r=l[22])&&h(e,"title",r)},d(v){v&&k(e),i=!1,c()}}}function dt(l){let e,t,s,o="ğŸ“ æ¨¡æ¿",a,n,u="ğŸ² é€šé…ç¬¦",r,i,c,p=l[0].length+"",v,f,_,b,d,y,O,g=l[1]&&De(l),E=l[2]&&Ae(l),F=l[3]&&Ie(l);return{c(){e=w("div"),t=w("div"),s=w("button"),s.textContent=o,a=B(),n=w("button"),n.textContent=u,r=B(),i=w("button"),c=M("ğŸ“œ å†å² ("),v=M(p),f=M(")"),_=B(),g&&g.c(),b=B(),E&&E.c(),d=B(),F&&F.c(),this.h()},l(j){e=D(j,"DIV",{class:!0});var H=A(e);t=D(H,"DIV",{class:!0});var Y=A(t);s=D(Y,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(s)!=="svelte-a9yep7"&&(s.textContent=o),a=I(Y),n=D(Y,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),X(n)!=="svelte-c8ivx2"&&(n.textContent=u),r=I(Y),i=D(Y,"BUTTON",{type:!0,class:!0});var V=A(i);c=U(V,"ğŸ“œ å†å² ("),v=U(V,p),f=U(V,")"),V.forEach(k),Y.forEach(k),_=I(H),g&&g.l(H),b=I(H),E&&E.l(H),d=I(H),F&&F.l(H),H.forEach(k),this.h()},h(){h(s,"type","button"),h(s,"class","btn-secondary text-sm svelte-flvc7i"),h(n,"type","button"),h(n,"class","btn-secondary text-sm svelte-flvc7i"),h(i,"type","button"),h(i,"class","btn-secondary text-sm svelte-flvc7i"),h(t,"class","flex gap-2 flex-wrap"),h(e,"class","prompt-tools space-y-2 svelte-flvc7i")},m(j,H){S(j,e,H),m(e,t),m(t,s),m(t,a),m(t,n),m(t,r),m(t,i),m(i,c),m(i,v),m(i,f),m(e,_),g&&g.m(e,null),m(e,b),E&&E.m(e,null),m(e,d),F&&F.m(e,null),y||(O=[R(s,"click",l[11]),R(n,"click",l[12]),R(i,"click",l[13])],y=!0)},p(j,[H]){H&1&&p!==(p=j[0].length+"")&&G(v,p),j[1]?g?g.p(j,H):(g=De(j),g.c(),g.m(e,b)):g&&(g.d(1),g=null),j[2]?E?E.p(j,H):(E=Ae(j),E.c(),E.m(e,d)):E&&(E.d(1),E=null),j[3]?F?F.p(j,H):(F=Ie(j),F.c(),F.m(e,null)):F&&(F.d(1),F=null)},i:Z,o:Z,d(j){j&&k(e),g&&g.d(),E&&E.d(),F&&F.d(),y=!1,Ze(O)}}}const Pe=20;function ht(l,e,t){let s;xe(l,le,V=>t(20,s=V));const o=[{name:"é»˜è®¤",value:""},{name:"å†™å®é£æ ¼",value:"photorealistic, highly detailed, 8k uhd, professional photography"},{name:"åŠ¨æ¼«é£æ ¼",value:"anime style, vibrant colors, detailed illustration, high quality"},{name:"æ²¹ç”»é£æ ¼",value:"oil painting, artistic, classical art style, detailed brushstrokes"},{name:"èµ›åšæœ‹å…‹",value:"cyberpunk style, neon lights, futuristic, sci-fi, detailed"},{name:"æ°´å½©ç”»",value:"watercolor painting, soft colors, artistic, delicate"}],a=[{name:"éšæœºé¢œè‰²",value:"{red|blue|green|yellow|purple|orange}"},{name:"éšæœºæ—¶é—´",value:"{morning|afternoon|evening|night}"},{name:"éšæœºå¤©æ°”",value:"{sunny|cloudy|rainy|snowy|foggy}"},{name:"éšæœºæƒ…ç»ª",value:"{happy|sad|angry|peaceful|excited}"}];let n=[];if(typeof window<"u"){const V=localStorage.getItem("prompt_history");if(V)try{n=JSON.parse(V)}catch(N){console.error("Failed to load prompt history:",N)}}function u(){typeof window<"u"&&localStorage.setItem("prompt_history",JSON.stringify(n))}function r(V){!V||V.trim()===""||(t(0,n=n.filter(N=>N!==V)),n.unshift(V),n.length>Pe&&t(0,n=n.slice(0,Pe)),u())}function i(V){const N=s.prompt||"",Q=N?`${N}, ${V}`:V;le.update(L=>({...L,prompt:Q}))}function c(V){const N=s.prompt||"",Q=N?`${N} ${V}`:V;le.update(L=>({...L,prompt:Q}))}function p(V){le.update(N=>({...N,prompt:V}))}function v(){confirm("ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ")&&(t(0,n=[]),u())}let f=!1,_=!1,b=!1;return[n,f,_,b,o,a,i,c,p,v,r,()=>t(1,f=!f),()=>t(2,_=!_),()=>t(3,b=!b),()=>t(1,f=!1),V=>i(V.value),()=>t(2,_=!1),V=>c(V.value),()=>t(3,b=!1),V=>p(V)]}class _t extends me{constructor(e){super(),ve(this,e,ht,dt,pe,{addToHistory:10})}get addToHistory(){return this.$$.ctx[10]}}function Se(l,e,t){const s=l.slice();return s[10]=e[t][0],s[11]=e[t][1],s}function Fe(l,e,t){const s=l.slice();return s[14]=e[t],s}function pt(l){let e,t,s,o,a,n,u,r,i;function c(...p){return l[9](l[11],l[10],...p)}return{c(){e=w("input"),this.h()},l(p){e=D(p,"INPUT",{type:!0,id:!0,class:!0,min:!0,max:!0,placeholder:!0}),this.h()},h(){h(e,"type",t=l[11].type||"text"),h(e,"id",s=l[10]),h(e,"class","input w-full"),e.value=o=l[2][l[10]]??l[11].default,h(e,"min",a=l[11].min),h(e,"max",n=l[11].max),h(e,"placeholder",u=l[11].title)},m(p,v){S(p,e,v),r||(i=R(e,"input",c),r=!0)},p(p,v){l=p,v&1&&t!==(t=l[11].type||"text")&&h(e,"type",t),v&1&&s!==(s=l[10])&&h(e,"id",s),v&5&&o!==(o=l[2][l[10]]??l[11].default)&&e.value!==o&&(e.value=o),v&1&&a!==(a=l[11].min)&&h(e,"min",a),v&1&&n!==(n=l[11].max)&&h(e,"max",n),v&1&&u!==(u=l[11].title)&&h(e,"placeholder",u)},i:Z,o:Z,d(p){p&&k(e),r=!1,i()}}}function mt(l){let e,t,s,o,a,n=l[11].values&&Le(l);function u(...r){return l[8](l[10],...r)}return{c(){e=w("select"),n&&n.c(),this.h()},l(r){e=D(r,"SELECT",{id:!0,class:!0});var i=A(e);n&&n.l(i),i.forEach(k),this.h()},h(){h(e,"id",t=l[10]),h(e,"class","input w-full")},m(r,i){S(r,e,i),n&&n.m(e,null),te(e,l[2][l[10]]??l[11].default),o||(a=R(e,"change",u),o=!0)},p(r,i){l=r,l[11].values?n?n.p(l,i):(n=Le(l),n.c(),n.m(e,null)):n&&(n.d(1),n=null),i&1&&t!==(t=l[10])&&h(e,"id",t),i&5&&s!==(s=l[2][l[10]]??l[11].default)&&te(e,l[2][l[10]]??l[11].default)},i:Z,o:Z,d(r){r&&k(e),n&&n.d(),o=!1,a()}}}function vt(l){let e,t,s,o,a,n,u,r,i,c=(l[2][l[10]]??l[11].default)+"",p,v,f;function _(...b){return l[7](l[10],...b)}return{c(){e=w("div"),t=w("input"),r=B(),i=w("span"),p=M(c),this.h()},l(b){e=D(b,"DIV",{class:!0});var d=A(e);t=D(d,"INPUT",{type:!0,id:!0,class:!0,min:!0,max:!0,step:!0}),r=I(d),i=D(d,"SPAN",{class:!0});var y=A(i);p=U(y,c),y.forEach(k),d.forEach(k),this.h()},h(){h(t,"type","range"),h(t,"id",s=l[10]),h(t,"class","flex-1"),h(t,"min",o=l[11].min??0),h(t,"max",a=l[11].max??100),h(t,"step",n=l[10]==="cfg_scale"||l[10]==="denoise"?.1:1),t.value=u=l[2][l[10]]??l[11].default,h(i,"class","text-sm text-text-secondary min-w-[60px] text-right"),h(e,"class","flex items-center gap-4")},m(b,d){S(b,e,d),m(e,t),m(e,r),m(e,i),m(i,p),v||(f=R(t,"input",_),v=!0)},p(b,d){l=b,d&1&&s!==(s=l[10])&&h(t,"id",s),d&1&&o!==(o=l[11].min??0)&&h(t,"min",o),d&1&&a!==(a=l[11].max??100)&&h(t,"max",a),d&1&&n!==(n=l[10]==="cfg_scale"||l[10]==="denoise"?.1:1)&&h(t,"step",n),d&5&&u!==(u=l[2][l[10]]??l[11].default)&&(t.value=u),d&5&&c!==(c=(l[2][l[10]]??l[11].default)+"")&&G(p,c)},i:Z,o:Z,d(b){b&&k(e),v=!1,f()}}}function bt(l){let e,t,s,o,a,n,u,r,i;function c(...v){return l[5](l[10],...v)}let p=l[10]==="prompt"&&He(l);return{c(){e=w("textarea"),a=B(),p&&p.c(),n=ue(),this.h()},l(v){e=D(v,"TEXTAREA",{id:!0,class:!0,rows:!0,placeholder:!0}),A(e).forEach(k),a=I(v),p&&p.l(v),n=ue(),this.h()},h(){h(e,"id",t=l[10]),h(e,"class","input-textarea w-full"),h(e,"rows","3"),e.value=s=l[2][l[10]]??l[11].default,h(e,"placeholder",o=l[11].title)},m(v,f){S(v,e,f),S(v,a,f),p&&p.m(v,f),S(v,n,f),u=!0,r||(i=R(e,"input",c),r=!0)},p(v,f){l=v,(!u||f&1&&t!==(t=l[10]))&&h(e,"id",t),(!u||f&5&&s!==(s=l[2][l[10]]??l[11].default))&&(e.value=s),(!u||f&1&&o!==(o=l[11].title))&&h(e,"placeholder",o),l[10]==="prompt"?p?(p.p(l,f),f&1&&ee(p,1)):(p=He(l),p.c(),ee(p,1),p.m(n.parentNode,n)):p&&(be(),oe(p,1,1,()=>{p=null}),ge())},i(v){u||(ee(p),u=!0)},o(v){oe(p),u=!1},d(v){v&&(k(e),k(a),k(n)),p&&p.d(v),r=!1,i()}}}function Le(l){let e,t=K(l[11].values),s=[];for(let o=0;o<t.length;o+=1)s[o]=je(Fe(l,t,o));return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ue()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ue()},m(o,a){for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(o,a);S(o,e,a)},p(o,a){if(a&1){t=K(o[11].values);let n;for(n=0;n<t.length;n+=1){const u=Fe(o,t,n);s[n]?s[n].p(u,a):(s[n]=je(u),s[n].c(),s[n].m(e.parentNode,e))}for(;n<s.length;n+=1)s[n].d(1);s.length=t.length}},d(o){o&&k(e),se(s,o)}}}function je(l){let e,t=l[14].label+"",s,o;return{c(){e=w("option"),s=M(t),this.h()},l(a){e=D(a,"OPTION",{});var n=A(e);s=U(n,t),n.forEach(k),this.h()},h(){e.__value=o=l[14].value,ne(e,e.__value)},m(a,n){S(a,e,n),m(e,s)},p(a,n){n&1&&t!==(t=a[14].label+"")&&G(s,t),n&1&&o!==(o=a[14].value)&&(e.__value=o,ne(e,e.__value))},d(a){a&&k(e)}}}function He(l){let e,t,s={};return e=new _t({props:s}),l[6](e),{c(){st(e.$$.fragment)},l(o){nt(e.$$.fragment,o)},m(o,a){ot(e,o,a),t=!0},p(o,a){const n={};e.$set(n)},i(o){t||(ee(e.$$.fragment,o),t=!0)},o(o){oe(e.$$.fragment,o),t=!1},d(o){l[6](null),rt(e,o)}}}function Me(l){let e,t,s=(l[11].title||l[10])+"",o,a,n,u,r,i,c;const p=[bt,vt,mt,pt],v=[];function f(_,b){return _[11].field==="textarea"?0:_[11].field==="range"?1:_[11].field==="select"?2:3}return u=f(l),r=v[u]=p[u](l),{c(){e=w("div"),t=w("label"),o=M(s),n=B(),r.c(),i=B(),this.h()},l(_){e=D(_,"DIV",{class:!0});var b=A(e);t=D(b,"LABEL",{class:!0,for:!0});var d=A(t);o=U(d,s),d.forEach(k),n=I(b),r.l(b),i=I(b),b.forEach(k),this.h()},h(){h(t,"class","label"),h(t,"for",a=l[10]),h(e,"class","space-y-2")},m(_,b){S(_,e,b),m(e,t),m(t,o),m(e,n),v[u].m(e,null),m(e,i),c=!0},p(_,b){(!c||b&1)&&s!==(s=(_[11].title||_[10])+"")&&G(o,s),(!c||b&1&&a!==(a=_[10]))&&h(t,"for",a);let d=u;u=f(_),u===d?v[u].p(_,b):(be(),oe(v[d],1,1,()=>{v[d]=null}),ge(),r=v[u],r?r.p(_,b):(r=v[u]=p[u](_),r.c()),ee(r,1),r.m(e,i))},i(_){c||(ee(r),c=!0)},o(_){oe(r),c=!1},d(_){_&&k(e),v[u].d()}}}function gt(l){let e,t,s=K(Object.entries(l[0])),o=[];for(let n=0;n<s.length;n+=1)o[n]=Me(Se(l,s,n));const a=n=>oe(o[n],1,1,()=>{o[n]=null});return{c(){e=w("div");for(let n=0;n<o.length;n+=1)o[n].c();this.h()},l(n){e=D(n,"DIV",{class:!0});var u=A(e);for(let r=0;r<o.length;r+=1)o[r].l(u);u.forEach(k),this.h()},h(){h(e,"class","space-y-4")},m(n,u){S(n,e,u);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(e,null);t=!0},p(n,[u]){if(u&15){s=K(Object.entries(n[0]));let r;for(r=0;r<s.length;r+=1){const i=Se(n,s,r);o[r]?(o[r].p(i,u),ee(o[r],1)):(o[r]=Me(i),o[r].c(),ee(o[r],1),o[r].m(e,null))}for(be(),r=s.length;r<o.length;r+=1)a(r);ge()}},i(n){if(!t){for(let u=0;u<s.length;u+=1)ee(o[u]);t=!0}},o(n){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)oe(o[u]);t=!1},d(n){n&&k(e),se(o,n)}}}function kt(l,e,t){let s,o;xe(l,le,f=>t(4,o=f));let{pipelineParams:a}=e,n;function u(f,_){le.update(b=>(b[f]=_,b)),f==="prompt"&&_&&_.trim()!==""&&n&&n.addToHistory(_)}const r=(f,_)=>u(f,_.currentTarget.value);function i(f){tt[f?"unshift":"push"](()=>{n=f,t(1,n)})}const c=(f,_)=>u(f,Number(_.currentTarget.value)),p=(f,_)=>u(f,_.currentTarget.value),v=(f,_,b)=>{const d=f.type==="number"?Number(b.currentTarget.value):b.currentTarget.value;u(_,d)};return l.$$set=f=>{"pipelineParams"in f&&t(0,a=f.pipelineParams)},l.$$.update=()=>{l.$$.dirty&16&&t(2,s=o)},[a,n,s,u,o,r,i,c,p,v]}class Ot extends me{constructor(e){super(),ve(this,e,kt,gt,pe,{pipelineParams:0})}}function _e(l){const e=l.slice(),t=e[2].find(s=>s.id===e[5]);return e[16]=t,e}function Ue(l,e,t){const s=l.slice();return s[16]=e[t],s}function Re(l,e,t){const s=l.slice();return s[19]=e[t],s}function Je(l,e,t){const s=l.slice();return s[22]=e[t],s}function qe(l){let e,t;return{c(){e=w("div"),t=M(l[7]),this.h()},l(s){e=D(s,"DIV",{class:!0});var o=A(e);t=U(o,l[7]),o.forEach(k),this.h()},h(){h(e,"class","px-3 py-2 bg-danger/10 border border-danger/30 rounded-lg text-sm text-danger")},m(s,o){S(s,e,o),m(e,t)},p(s,o){o&128&&G(t,s[7])},d(s){s&&k(e)}}}function We(l){let e,t;return{c(){e=w("div"),t=M(l[8]),this.h()},l(s){e=D(s,"DIV",{class:!0});var o=A(e);t=U(o,l[8]),o.forEach(k),this.h()},h(){h(e,"class","px-3 py-2 bg-success/10 border border-success/30 rounded-lg text-sm text-success")},m(s,o){S(s,e,o),m(e,t)},p(s,o){o&256&&G(t,s[8])},d(s){s&&k(e)}}}function Ke(l){let e,t=l[22].name+"",s,o,a=l[22].loaded?"(å½“å‰)":"",n,u,r;return{c(){e=w("option"),s=M(t),o=B(),n=M(a),u=B(),this.h()},l(i){e=D(i,"OPTION",{});var c=A(e);s=U(c,t),o=I(c),n=U(c,a),u=I(c),c.forEach(k),this.h()},h(){e.__value=r=l[22].id,ne(e,e.__value)},m(i,c){S(i,e,c),m(e,s),m(e,o),m(e,n),m(e,u)},p(i,c){c&1&&t!==(t=i[22].name+"")&&G(s,t),c&1&&a!==(a=i[22].loaded?"(å½“å‰)":"")&&G(n,a),c&1&&r!==(r=i[22].id)&&(e.__value=r,ne(e,e.__value))},d(i){i&&k(e)}}}function ze(l){let e,t=l[19].name+"",s,o,a=l[19].loaded?"(å½“å‰)":"",n,u,r;return{c(){e=w("option"),s=M(t),o=B(),n=M(a),u=B(),this.h()},l(i){e=D(i,"OPTION",{});var c=A(e);s=U(c,t),o=I(c),n=U(c,a),u=I(c),c.forEach(k),this.h()},h(){e.__value=r=l[19].id,ne(e,e.__value)},m(i,c){S(i,e,c),m(e,s),m(e,o),m(e,n),m(e,u)},p(i,c){c&2&&t!==(t=i[19].name+"")&&G(s,t),c&2&&a!==(a=i[19].loaded?"(å½“å‰)":"")&&G(n,a),c&2&&r!==(r=i[19].id)&&(e.__value=r,ne(e,e.__value))},d(i){i&&k(e)}}}function Xe(l){let e,t=l[16].name+"",s,o,a=l[16].loaded?"(å½“å‰)":"",n,u,r;return{c(){e=w("option"),s=M(t),o=B(),n=M(a),u=B(),this.h()},l(i){e=D(i,"OPTION",{});var c=A(e);s=U(c,t),o=I(c),n=U(c,a),u=I(c),c.forEach(k),this.h()},h(){e.__value=r=l[16].id,ne(e,e.__value)},m(i,c){S(i,e,c),m(e,s),m(e,o),m(e,n),m(e,u)},p(i,c){c&4&&t!==(t=i[16].name+"")&&G(s,t),c&4&&a!==(a=i[16].loaded?"(å½“å‰)":"")&&G(n,a),c&4&&r!==(r=i[16].id)&&(e.__value=r,ne(e,e.__value))},d(i){i&&k(e)}}}function Ge(l){let e,t=l[16]&&l[16].description&&Ye(l);return{c(){t&&t.c(),e=ue()},l(s){t&&t.l(s),e=ue()},m(s,o){t&&t.m(s,o),S(s,e,o)},p(s,o){s[16]&&s[16].description?t?t.p(s,o):(t=Ye(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(s){s&&k(e),t&&t.d(s)}}}function Ye(l){let e,t=l[16].description+"",s;return{c(){e=w("p"),s=M(t),this.h()},l(o){e=D(o,"P",{class:!0});var a=A(e);s=U(a,t),a.forEach(k),this.h()},h(){h(e,"class","text-xs text-text-secondary mt-1")},m(o,a){S(o,e,a),m(e,s)},p(o,a){a&36&&t!==(t=o[16].description+"")&&G(s,t)},d(o){o&&k(e)}}}function Qe(l){let e,t='<div class="animate-spin h-4 w-4 border-2 border-primary border-t-transparent rounded-full"></div> <span class="text-sm text-text-secondary">åˆ‡æ¢ä¸­...</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(s){e=D(s,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1kul7h"&&(e.innerHTML=t),this.h()},h(){h(e,"class","flex items-center gap-2 px-3 py-2 bg-primary/10 border border-primary/30 rounded-lg")},m(s,o){S(s,e,o)},d(s){s&&k(e)}}}function yt(l){let e,t,s,o,a,n="æ¨¡å‹",u,r,i,c,p,v="VAE",f,_,b,d,y,O="é‡‡æ ·å™¨",g,E,F,j,H,Y,V=l[7]&&qe(l),N=l[8]&&We(l),Q=K(l[0]),L=[];for(let C=0;C<Q.length;C+=1)L[C]=Ke(Je(l,Q,C));let re=K(l[1]),J=[];for(let C=0;C<re.length;C+=1)J[C]=ze(Re(l,re,C));let ae=K(l[2]),q=[];for(let C=0;C<ae.length;C+=1)q[C]=Xe(Ue(l,ae,C));let W=l[5]&&Ge(_e(l)),z=l[6]&&Qe();return{c(){e=w("div"),V&&V.c(),t=B(),N&&N.c(),s=B(),o=w("div"),a=w("label"),a.textContent=n,u=B(),r=w("select");for(let C=0;C<L.length;C+=1)L[C].c();i=B(),c=w("div"),p=w("label"),p.textContent=v,f=B(),_=w("select");for(let C=0;C<J.length;C+=1)J[C].c();b=B(),d=w("div"),y=w("label"),y.textContent=O,g=B(),E=w("select");for(let C=0;C<q.length;C+=1)q[C].c();F=B(),W&&W.c(),j=B(),z&&z.c(),this.h()},l(C){e=D(C,"DIV",{class:!0});var P=A(e);V&&V.l(P),t=I(P),N&&N.l(P),s=I(P),o=D(P,"DIV",{class:!0});var T=A(o);a=D(T,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(a)!=="svelte-1ptzy1b"&&(a.textContent=n),u=I(T),r=D(T,"SELECT",{id:!0,class:!0});var x=A(r);for(let $=0;$<L.length;$+=1)L[$].l(x);x.forEach(k),T.forEach(k),i=I(P),c=D(P,"DIV",{class:!0});var ce=A(c);p=D(ce,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(p)!=="svelte-13pu0rc"&&(p.textContent=v),f=I(ce),_=D(ce,"SELECT",{id:!0,class:!0});var ke=A(_);for(let $=0;$<J.length;$+=1)J[$].l(ke);ke.forEach(k),ce.forEach(k),b=I(P),d=D(P,"DIV",{class:!0});var ie=A(d);y=D(ie,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),X(y)!=="svelte-jehhn9"&&(y.textContent=O),g=I(ie),E=D(ie,"SELECT",{id:!0,class:!0});var ye=A(E);for(let $=0;$<q.length;$+=1)q[$].l(ye);ye.forEach(k),F=I(ie),W&&W.l(ie),ie.forEach(k),j=I(P),z&&z.l(P),P.forEach(k),this.h()},h(){h(a,"for","model-select"),h(a,"class","block text-sm font-medium text-text-primary"),h(r,"id","model-select"),r.disabled=l[6],h(r,"class","w-full px-3 py-2 bg-surface-elevated border border-border rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50"),l[3]===void 0&&fe(()=>l[12].call(r)),h(o,"class","space-y-2"),h(p,"for","vae-select"),h(p,"class","block text-sm font-medium text-text-primary"),h(_,"id","vae-select"),_.disabled=l[6],h(_,"class","w-full px-3 py-2 bg-surface-elevated border border-border rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50"),l[4]===void 0&&fe(()=>l[13].call(_)),h(c,"class","space-y-2"),h(y,"for","scheduler-select"),h(y,"class","block text-sm font-medium text-text-primary"),h(E,"id","scheduler-select"),E.disabled=l[6],h(E,"class","w-full px-3 py-2 bg-surface-elevated border border-border rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50"),l[5]===void 0&&fe(()=>l[14].call(E)),h(d,"class","space-y-2"),h(e,"class","space-y-4")},m(C,P){S(C,e,P),V&&V.m(e,null),m(e,t),N&&N.m(e,null),m(e,s),m(e,o),m(o,a),m(o,u),m(o,r);for(let T=0;T<L.length;T+=1)L[T]&&L[T].m(r,null);te(r,l[3],!0),m(e,i),m(e,c),m(c,p),m(c,f),m(c,_);for(let T=0;T<J.length;T+=1)J[T]&&J[T].m(_,null);te(_,l[4],!0),m(e,b),m(e,d),m(d,y),m(d,g),m(d,E);for(let T=0;T<q.length;T+=1)q[T]&&q[T].m(E,null);te(E,l[5],!0),m(d,F),W&&W.m(d,null),m(e,j),z&&z.m(e,null),H||(Y=[R(r,"change",l[12]),R(r,"change",l[9]),R(_,"change",l[13]),R(_,"change",l[10]),R(E,"change",l[14]),R(E,"change",l[11])],H=!0)},p(C,[P]){if(C[7]?V?V.p(C,P):(V=qe(C),V.c(),V.m(e,t)):V&&(V.d(1),V=null),C[8]?N?N.p(C,P):(N=We(C),N.c(),N.m(e,s)):N&&(N.d(1),N=null),P&1){Q=K(C[0]);let T;for(T=0;T<Q.length;T+=1){const x=Je(C,Q,T);L[T]?L[T].p(x,P):(L[T]=Ke(x),L[T].c(),L[T].m(r,null))}for(;T<L.length;T+=1)L[T].d(1);L.length=Q.length}if(P&64&&(r.disabled=C[6]),P&9&&te(r,C[3]),P&2){re=K(C[1]);let T;for(T=0;T<re.length;T+=1){const x=Re(C,re,T);J[T]?J[T].p(x,P):(J[T]=ze(x),J[T].c(),J[T].m(_,null))}for(;T<J.length;T+=1)J[T].d(1);J.length=re.length}if(P&64&&(_.disabled=C[6]),P&18&&te(_,C[4]),P&4){ae=K(C[2]);let T;for(T=0;T<ae.length;T+=1){const x=Ue(C,ae,T);q[T]?q[T].p(x,P):(q[T]=Xe(x),q[T].c(),q[T].m(E,null))}for(;T<q.length;T+=1)q[T].d(1);q.length=ae.length}P&64&&(E.disabled=C[6]),P&36&&te(E,C[5]),C[5]?W?W.p(_e(C),P):(W=Ge(_e(C)),W.c(),W.m(d,null)):W&&(W.d(1),W=null),C[6]?z||(z=Qe(),z.c(),z.m(e,null)):z&&(z.d(1),z=null)},i:Z,o:Z,d(C){C&&k(e),V&&V.d(),N&&N.d(),se(L,C),se(J,C),se(q,C),W&&W.d(),z&&z.d(),H=!1,Ze(Y)}}}function Et(l,e,t){let s=[],o=[],a=[],n="",u="",r="",i=!1,c="",p="";lt(async()=>{await v()});async function v(){try{const E=await(await fetch("/api/models")).json();t(0,s=E.models||[]);const F=s.find(L=>L.loaded);F&&t(3,n=F.id);const H=await(await fetch("/api/vaes")).json();t(1,o=H.vaes||[]);const Y=o.find(L=>L.loaded);Y&&t(4,u=Y.id);const N=await(await fetch("/api/schedulers")).json();t(2,a=N.schedulers||[]);const Q=a.find(L=>L.loaded);Q&&t(5,r=Q.id)}catch(g){t(7,c="åŠ è½½é€‰é¡¹å¤±è´¥: "+(g instanceof Error?g.message:String(g))),console.error("åŠ è½½é€‰é¡¹å¤±è´¥:",g)}}async function f(){if(!n){t(7,c="è¯·é€‰æ‹©ä¸€ä¸ªæ¨¡å‹");return}t(6,i=!0),t(7,c=""),t(8,p="");try{const E=await(await fetch("/api/models/switch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_id:n,vae_id:u,scheduler_id:r})})).json();E.success?(t(8,p=E.message||"æ¨¡å‹åˆ‡æ¢æˆåŠŸ"),await v(),setTimeout(()=>{t(8,p="")},3e3)):t(7,c=E.message||"æ¨¡å‹åˆ‡æ¢å¤±è´¥")}catch(g){t(7,c="æ¨¡å‹åˆ‡æ¢å¤±è´¥: "+(g instanceof Error?g.message:String(g))),console.error("æ¨¡å‹åˆ‡æ¢å¤±è´¥:",g)}finally{t(6,i=!1)}}async function _(){if(!u){t(7,c="è¯·é€‰æ‹©ä¸€ä¸ªVAE");return}t(6,i=!0),t(7,c=""),t(8,p="");try{const E=await(await fetch("/api/vae/switch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({vae_id:u})})).json();E.success?(t(8,p=E.message||"VAEåˆ‡æ¢æˆåŠŸ"),await v(),setTimeout(()=>{t(8,p="")},3e3)):t(7,c=E.message||"VAEåˆ‡æ¢å¤±è´¥")}catch(g){t(7,c="VAEåˆ‡æ¢å¤±è´¥: "+(g instanceof Error?g.message:String(g))),console.error("VAEåˆ‡æ¢å¤±è´¥:",g)}finally{t(6,i=!1)}}async function b(){if(!r){t(7,c="è¯·é€‰æ‹©ä¸€ä¸ªé‡‡æ ·å™¨");return}t(6,i=!0),t(7,c=""),t(8,p="");try{const E=await(await fetch("/api/scheduler/set",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduler:r})})).json();E.success?(t(8,p=E.message||"é‡‡æ ·å™¨åˆ‡æ¢æˆåŠŸ"),await v(),setTimeout(()=>{t(8,p="")},3e3)):t(7,c=E.message||"é‡‡æ ·å™¨åˆ‡æ¢å¤±è´¥")}catch(g){t(7,c="é‡‡æ ·å™¨åˆ‡æ¢å¤±è´¥: "+(g instanceof Error?g.message:String(g))),console.error("é‡‡æ ·å™¨åˆ‡æ¢å¤±è´¥:",g)}finally{t(6,i=!1)}}function d(){n=de(this),t(3,n),t(0,s)}function y(){u=de(this),t(4,u),t(1,o)}function O(){r=de(this),t(5,r),t(2,a)}return[s,o,a,n,u,r,i,c,p,f,_,b,d,y,O]}class Nt extends me{constructor(e){super(),ve(this,e,Et,yt,pe,{})}}export{it as E,Nt as M,Ot as P,It as a,At as c,et as e,Bt as g,le as p,Vt as s};
